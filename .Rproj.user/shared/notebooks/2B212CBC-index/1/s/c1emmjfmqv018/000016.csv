"0","#| label: fig-level-curves"
"0","#| fig-cap: 1000 samples from the joint density of $\theta$.  Dashed line indicates where region of 95\% probability, solid line indicates region of 99\% probability."
"0","sigma_1 <- sqrt(qchisq(0.95, 2))"
"0","sigma_2 <- sqrt(qchisq(0.99, 2))"
"0","sig<- matrix(c(p*(1-p)/n, p*(1-p)/(2*n), p*(1-p)/(2*n), p*(1-p)/(2*n) ), nrow = 2)"
"0","tt <- seq(0, 1, 0.01)"
"0","x <- cos(2*pi*tt)"
"0","y <- sin(2*pi*tt)"
"0","R <- cbind(x,y)"
"0",""
"0",""
"0","e = eigen(sig)"
"0","V = sqrt(diag(e$values))"
"0",""
"0","level_curve_1 <- sigma_1*R %*% (e$vectors %*% V %*% t(e$vectors)) + p"
"0","colnames(level_curve_1) <- c(""X1"", ""X2"")"
"0","level_curve_1 <- as_tibble(level_curve_1)"
"0",""
"0","level_curve_2 <- sigma_2*R %*% (e$vectors %*% V %*% t(e$vectors)) + p"
"0","colnames(level_curve_2) <- c(""X1"", ""X2"")"
"0","level_curve_2 <- as_tibble(level_curve_2)"
"0",""
"0","joint <-sims %>% "
"0","  select(sim, K, samples) %>% "
"0","  pivot_wider(names_from='K', values_from='samples') %>% "
"0","  rename(X1 = `k=1`, X2=`k=2`) %>% "
"0","  select(-sim)"
"0",""
"0","joint %>% "
"0","  sample_n(1000) %>% "
"0","  ggplot(aes(X1, X2))+"
"0","  geom_point(color = 'dark gray', fill='gray', alpha = 0.5, shape=21)+"
"0","  geom_abline(aes(slope=1, intercept=0))+"
"0","  geom_path(data=level_curve_1, aes(X1, X2), color = my_blue, linetype='dashed')+"
"0","  geom_path(data=level_curve_2, aes(X1, X2), color = my_blue)+"
"0","  lims(x=c(.4, .6), y=c(.4, .6))+"
"0","  theme("
"0","    panel.grid.major = element_line(),"
"0","    aspect.ratio = 1"
"0","  )+"
"0","  labs(x=expression(bar(X)[1]),"
"0","       y=expression(bar(X)[2]))"
