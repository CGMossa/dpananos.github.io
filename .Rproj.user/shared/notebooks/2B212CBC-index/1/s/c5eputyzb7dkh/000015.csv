"0","#| label: marginal-density"
"0","#| fig-cap: Densities of the mean for each stake $K=1$ and $K=2$"
"0",""
"0","library(tidyverse)"
"0","my_blue <- rgb(45/250, 62/250, 80/250, 1)"
"0","theme_set(theme_classic())"
"0",""
"0",""
"0","p <- 0.5"
"0","n <- 500"
"0","sds <- sqrt(p*(1-p)/(1:2*n))"
"0","nsims <- 2000"
"0",""
"0","set.seed(0)"
"0","sims<-rerun(nsims, {"
"0","    X1 <- rbinom(1, n, p)/n"
"0","    X2 <- (n*X1 + rbinom(1, n, p))/(2*n)"
"0",""
"0","    K <- c('k=1','k=2')"
"0","    samples <- c(X1, X2)"
"0","    "
"0","    tibble(K, samples, mu=p, sd = sqrt(p*(1-p)/(1:2*n)))"
"0","}) %>%"
"0","bind_rows(.id = 'sim')"
"0",""
"0",""
"0","sims %>% "
"0","  ggplot(aes(samples))+"
"0","  geom_histogram(aes(y=..density..), fill = 'light gray', color = 'black')+"
"0","  facet_wrap(~K) + "
"0","  geom_line(aes(y = dnorm(samples,"
"0","                          mean = p,"
"0","                          sd = sds[PANEL])),"
"0","            color = my_blue, "
"0","            size = 1)+"
"0","  theme("
"0","    panel.grid.major = element_line()"
"0","  )+"
"0","  labs(y='Density',"
"0","       x = expression(bar(X)[k]))"
"2","`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
"
